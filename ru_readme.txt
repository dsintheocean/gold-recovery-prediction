Необходимо подготовить прототип модели машинного обучения.
Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. В распоряжении данные с параметрами добычи и очистки.
Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

Данные находятся в трёх файлах:
gold_industry_train.csv — обучающая выборка;
https://drive.google.com/file/d/1lHRlYIG77aAHWdvpq4-kFID-rVzxexKF/view?usp=sharing

gold_industry_test.csv — тестовая выборка;
https://drive.google.com/file/d/15SKLCkP37PmzYRsUlX0AYTQbM7y3AxkG/view?usp=sharing

gold_industry_full.csv — исходные данные. 
https://drive.google.com/file/d/1GhqnlOwf9fCuE3FRw8FkMzc_mrWS-Xbr/view?usp=sharing

Данные индексируются датой и временем получения информации (признак date). Соседние по времени параметры часто похожи. Данные выгружаются из АСУ ТП предприятия.
Некоторые параметры недоступны, потому что замеряются и/или рассчитываются значительно позже. Из-за этого в тестовой выборке отсутствуют некоторые признаки, которые могут быть в обучающей. Также в тестовом наборе нет целевых признаков.
Исходный датасет содержит обучающую и тестовую выборки со всеми признаками.
В распоряжении сырые данные: их просто выгрузили из хранилища.

Технологический процесс
Как золото получают из руды? 
Когда добытая руда проходит первичную обработку, получается дроблёная смесь. Её отправляют на флотацию (обогащение) и двухэтапную очистку.

Опишем каждую стадию: 
1. Флотация
Во флотационную установку подаётся смесь золотосодержащей руды. После обогащения получается черновой концентрат и «отвальные хвосты», то есть остатки продукта с низкой концентрацией ценных металлов.
На стабильность этого процесса влияет непостоянное и неоптимальное физико-химическое состояние флотационной пульпы (смеси твёрдых частиц и жидкости).

2. Очистка
Черновой концентрат проходит две очистки. На выходе получается финальный концентрат и новые отвальные хвосты.

Описание данных
- Rougher feed — исходное сырье
- Rougher additions (или reagent additions) — флотационные реагенты: Xanthate, Sulphate, Depressant
- Xanthate — ксантогенат (промотер, или активатор флотации);
- Sulphate — сульфат (на данном производстве сульфид натрия);
- Depressant — депрессант (силикат натрия).
- Rougher process (англ. «грубый процесс») — флотация
- Rougher tails — отвальные хвосты
- Float banks — флотационная установка
- Cleaner process — очистка
- Rougher Au — черновой концентрат золота
- Final Au — финальный концентрат золота

Параметры этапов
- air amount — объём воздуха
- fluid levels — уровень жидкости
- feed size — размер гранул сырья
- feed rate — скорость подачи

Наименование признаков
`[этап].[тип_параметра].[название_параметра]`
Пример: `rougher.input.feed_ag`

Расчёт эффективности
Необходимо смоделировать процесс восстановления золота из золотосодержащей руды. 
Эффективность обогащения рассчитывается по формуле, в которую входят след. параметры:
- C — доля золота в концентрате после флотации/очистки;
- F — доля золота в сырье/концентрате до флотации/очистки;
- T — доля золота в отвальных хвостах после флотации/очистки.

Для прогноза коэффициента нужно найти долю золота в концентратах и хвостах. 
Причём важен не только финальный продукт, но и черновой концентрат.

Метрика качества
Для решения задачи используется метрика качества — sMAPE (англ. Symmetric Mean Absolute Percentage Error, «симметричное среднее абсолютное процентное отклонение»).
Она похожа на MAE, но выражается не в абсолютных величинах, а в относительных. Симметричная - т.к. она одинаково учитывает масштаб и целевого признака, и предсказания.
Метрика sMAPE вычисляется с использованием следующих параметров:
- Yi - Значение целевого признака для объекта с порядковым номером i в выборке, на которой измеряется качество.
- Ẏi - Значение предсказания для объекта с порядковым номером i, например, в тестовой выборке.
- N - Количество объектов в выборке.
- Σ - Суммирование по всем объектам выборки (i меняется от 1 до N).

Нужно спрогнозировать сразу две величины (целевые признаки):
1. эффективность обогащения чернового концентрата `rougher.output.recovery`;
2. эффективность обогащения финального концентрата `final.output.recovery`.
Итоговая метрика складывается из данных двух величин.